//
//  HeightMap.swift
//  EmojiRPG
//
//  Created by Suisei killfaeh on 31/12/2024.
//

import Foundation

enum ğŸ”ï¸ğŸ“ğŸ”ï¸
{
   case ğŸ“, ğŸ², ğŸ²ğŸ“, ğŸ¢, ğŸ²ğŸ²
}

class ğŸ”ï¸ğŸ—ºï¸
{
    var ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸšï¸ = ğŸ”ï¸ğŸ“ğŸ”ï¸.ğŸ“
    var ğŸ”²ğŸ“ = 10
    var ğŸ”²ğŸ“ = 10
    var ğŸ”²ğŸ”ï¸ğŸ“ğŸ”ï¸ = 16
    
    var ğŸ”²ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ“: Int
    {
        get
        {
            return (ğŸ”²ğŸ“+1)*ğŸ”²ğŸ”ï¸ğŸ“ğŸ”ï¸
        }
    }
    
    var ğŸ”²ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ“: Int
    {
        get
        {
            return (ğŸ”²ğŸ“+1)*ğŸ”²ğŸ”ï¸ğŸ“ğŸ”ï¸
        }
    }
    
    var ğŸ›«ğŸ—ºï¸: [[Double]] = []
    var ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ—ºï¸: [[Double]] = []
    static var ğŸ“¤ğŸ—ºï¸: [[Double]] = []
    
    static var ğŸ§®ğŸ”ï¸ğŸ“ğŸ”ï¸ = 0
    static var ğŸ“ğŸ“ğŸ”ï¸ğŸ“ğŸ”ï¸ = DispatchQueue(label: "ğŸ”ï¸ğŸ“ğŸ”ï¸")
    
    static func ğŸ› ï¸ğŸ¢(_ ğŸ“¥ğŸ›ï¸: [Double], _ ğŸ“¥ğŸ“: Double) -> Double
    {
        var ğŸ“¤ğŸ“: Double = 0.0
        
        for ğŸ‘† in 0..<ğŸ“¥ğŸ›ï¸.count
        {
            ğŸ“¤ğŸ“ = ğŸ“¤ğŸ“ + ğŸ“¥ğŸ›ï¸[ğŸ‘†]*pow(ğŸ“¥ğŸ“, Double(ğŸ“¥ğŸ›ï¸.count-1-ğŸ‘†))
        }
        
        return ğŸ“¤ğŸ“
    }
    
    func ğŸ› ï¸ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ“(_ ğŸ“¥ğŸ“ğŸ‘†: Double, _ ğŸ“¥ğŸ“ğŸ–•: Double, _ ğŸ“¥ğŸ“: Double) -> Double
    {
        return ğŸ”ï¸ğŸ—ºï¸.ğŸ› ï¸ğŸ¢([ğŸ“¥ğŸ“ğŸ–•-ğŸ“¥ğŸ“ğŸ‘†, ğŸ“¥ğŸ“ğŸ‘†], ğŸ“¥ğŸ“)
    }
    
    func ğŸ› ï¸ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ²(_ ğŸ“¥ğŸ“ğŸ‘†: Double, _ ğŸ“¥ğŸ“ğŸ–•: Double, _ ğŸ“¥ğŸ“: Double) -> Double
    {
        var ğŸ“¤ğŸ“: Double = 0.0
        
        if ğŸ“¥ğŸ“ >= 0.0 && ğŸ“¥ğŸ“ <= 1.0
        {
            let ğŸ›ï¸ğŸ›ï¸ = [ğŸ“¥ğŸ“ğŸ–•-ğŸ“¥ğŸ“ğŸ‘†, ğŸ“¥ğŸ“ğŸ‘†]
            ğŸ“¤ğŸ“ = ğŸ”ï¸ğŸ—ºï¸.ğŸ› ï¸ğŸ¢(ğŸ›ï¸ğŸ›ï¸, 3.0*ğŸ“¥ğŸ“*ğŸ“¥ğŸ“ - 2.0*ğŸ“¥ğŸ“*ğŸ“¥ğŸ“*ğŸ“¥ğŸ“)
        }
        
        return ğŸ“¤ğŸ“
    }
    
    func ğŸ› ï¸ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ²ğŸ“(_ ğŸ“¥ğŸ“ğŸ‘†: Double, _ ğŸ“¥ğŸ“ğŸ–•: Double, _ ğŸ“¥ğŸ“: Double) -> Double
    {
        var ğŸ“¤ğŸ“: Double = 0.0
        
        if ğŸ“¥ğŸ“ >= 0.0 && ğŸ“¥ğŸ“ <= 1.0
        {
            let ğŸ›ï¸ğŸ›ï¸ = [ğŸ“¥ğŸ“ğŸ–•-ğŸ“¥ğŸ“ğŸ‘†, ğŸ“¥ğŸ“ğŸ‘†]
            ğŸ“¤ğŸ“ = ğŸ”ï¸ğŸ—ºï¸.ğŸ› ï¸ğŸ¢(ğŸ›ï¸ğŸ›ï¸, 6.0*ğŸ“¥ğŸ“*ğŸ“¥ğŸ“*ğŸ“¥ğŸ“*ğŸ“¥ğŸ“*ğŸ“¥ğŸ“ - 15.0*ğŸ“¥ğŸ“*ğŸ“¥ğŸ“*ğŸ“¥ğŸ“*ğŸ“¥ğŸ“ + 10.0*ğŸ“¥ğŸ“*ğŸ“¥ğŸ“*ğŸ“¥ğŸ“)
        }
        
        return ğŸ“¤ğŸ“
    }
    
    func ğŸ› ï¸ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ¢(_ ğŸ“¥ğŸ“ğŸ‘†: Double, _ ğŸ“¥ğŸ“ğŸ–•: Double, _ ğŸ“¥ğŸ“: Double) -> Double
    {
        var ğŸ“¤ğŸ“: Double = 0.0
        
        if ğŸ“¥ğŸ“ >= 0.0 && ğŸ“¥ğŸ“ <= 1.0
        {
            let ğŸ›ï¸ğŸ›ï¸ = [ğŸ“¥ğŸ“ğŸ–•-ğŸ“¥ğŸ“ğŸ‘†, ğŸ“¥ğŸ“ğŸ‘†]
            ğŸ“¤ğŸ“ = ğŸ”ï¸ğŸ—ºï¸.ğŸ› ï¸ğŸ¢(ğŸ›ï¸ğŸ›ï¸, cos(ğŸ“¥ğŸ“*Double.pi)/2.0)
        }
        
        return ğŸ“¤ğŸ“
    }
    
    func ğŸ› ï¸ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ²ğŸ²(_ ğŸ“¥ğŸ“ğŸ‘†: Double, _ ğŸ“¥ğŸ“ğŸ–•: Double, _ ğŸ“¥ğŸ“ğŸ‘†ğŸ‘†: Double, _ ğŸ“¥ğŸ“ğŸ–•ğŸ–•: Double, _ ğŸ“¥ğŸ“: Double) -> Double
    {
        var ğŸ“¤ğŸ“: Double = 0.0
        
        if ğŸ“¥ğŸ“ >= 0.0 && ğŸ“¥ğŸ“ <= 1.0
        {
            var ğŸ›ï¸ğŸ›ï¸ = [ğŸ“¥ğŸ“ğŸ–•ğŸ–• - ğŸ“¥ğŸ“ğŸ‘†ğŸ‘† - ğŸ“¥ğŸ“ğŸ‘† + ğŸ“¥ğŸ“ğŸ–•]
            ğŸ›ï¸ğŸ›ï¸.append(ğŸ“¥ğŸ“ğŸ‘† - ğŸ“¥ğŸ“ğŸ–• - ğŸ›ï¸ğŸ›ï¸[0])
            ğŸ›ï¸ğŸ›ï¸.append(ğŸ“¥ğŸ“ğŸ‘†ğŸ‘† - ğŸ“¥ğŸ“ğŸ‘†)
            ğŸ›ï¸ğŸ›ï¸.append(ğŸ“¥ğŸ“ğŸ–•)
            
            ğŸ“¤ğŸ“ = ğŸ”ï¸ğŸ—ºï¸.ğŸ› ï¸ğŸ¢(ğŸ›ï¸ğŸ›ï¸, ğŸ“¥ğŸ“)
        }
        
        return ğŸ“¤ğŸ“
    }
    
    func ğŸ› ï¸ğŸ”ï¸ğŸ“ğŸ”ï¸()
    {
        if ğŸ›«ğŸ—ºï¸.count > 0
        {
            ğŸ”ï¸ğŸ—ºï¸.ğŸ“ğŸ“ğŸ”ï¸ğŸ“ğŸ”ï¸ = DispatchQueue(label: "ğŸ“ğŸ”ï¸ğŸ“")
            ğŸ”ï¸ğŸ—ºï¸.ğŸ§®ğŸ”ï¸ğŸ“ğŸ”ï¸ = 0
            
            ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ—ºï¸ = []
            
            for _ in 0..<ğŸ”²ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ“
            {
                let ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ—ºï¸ğŸ“ = [Double](repeating: 0.0, count: ğŸ”²ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ“)
                ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ—ºï¸.append(ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ—ºï¸ğŸ“)
            }
            
            for ğŸ‘† in 0..<ğŸ”²ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ“
            {
                for ğŸ–• in 0..<self.ğŸ”²ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ“
                {
                    self.ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ—ºï¸[ğŸ‘†][ğŸ–•] = self.ğŸ› ï¸(Double(ğŸ‘†), Double(ğŸ–•))
                }
            }
            
            let ğŸ“ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ—ºï¸ = ğŸ”ï¸ğŸ—ºï¸.ğŸ“ğŸ—ºï¸(ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ—ºï¸)
            ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ—ºï¸ = ğŸ“ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ—ºï¸
        }
    }
    
    func ğŸ› ï¸(_ ğŸ“¥ğŸ“ğŸ‘†: Double, _ ğŸ“¥ğŸ“ğŸ–•: Double) -> Double
    {
        var ğŸ“¤ğŸ“: Double = 0.0
        let ğŸ‘† = Int(ğŸ“¥ğŸ“ğŸ‘†/Double(ğŸ”²ğŸ”ï¸ğŸ“ğŸ”ï¸))
        let ğŸ–• = Int(ğŸ“¥ğŸ“ğŸ–•/Double(ğŸ”²ğŸ”ï¸ğŸ“ğŸ”ï¸))
        
        let ğŸ‘†0 = ğŸ‘†
        let ğŸ‘†ğŸ‘ˆ1 = ğŸ‘†-1
        var ğŸ‘†ğŸ‘‰1 = ğŸ‘†+1
                
        let ğŸ–•0 = ğŸ–•
        let ğŸ–•ğŸ‘ˆ1 = ğŸ–•-1
        var ğŸ–•ğŸ‘‰1 = ğŸ–•+1
        var ğŸ–•ğŸ‘‰2 = ğŸ–•+2
        
        if ğŸ‘† >= ğŸ”²ğŸ“
        {
            ğŸ‘†ğŸ‘‰1 = 0
        }
        
        if ğŸ–• >= ğŸ”²ğŸ“
        {
            ğŸ–•ğŸ‘‰1 = 0
            ğŸ–•ğŸ‘‰2 = 1
        }
        
        let ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ‘† = ğŸ“¥ğŸ“ğŸ‘†/Double(ğŸ”²ğŸ”ï¸ğŸ“ğŸ”ï¸) - Double(ğŸ‘†)
        let ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ–• = ğŸ“¥ğŸ“ğŸ–•/Double(ğŸ”²ğŸ”ï¸ğŸ“ğŸ”ï¸) - Double(ğŸ–•)
            
        switch ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸšï¸
        {
            case .ğŸ“:
                let ğŸ“¤ğŸ“ğŸ‘† = ğŸ› ï¸ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ“(ğŸ›«ğŸ—ºï¸[ğŸ‘†0][ğŸ–•0], ğŸ›«ğŸ—ºï¸[ğŸ‘†ğŸ‘‰1][ğŸ–•0], ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ‘†)
                let ğŸ“¤ğŸ“ğŸ–• = ğŸ› ï¸ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ“(ğŸ›«ğŸ—ºï¸[ğŸ‘†0][ğŸ–•ğŸ‘‰1], ğŸ›«ğŸ—ºï¸[ğŸ‘†ğŸ‘‰1][ğŸ–•ğŸ‘‰1], ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ‘†)
                ğŸ“¤ğŸ“ = ğŸ› ï¸ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ“(ğŸ“¤ğŸ“ğŸ‘†, ğŸ“¤ğŸ“ğŸ–•, ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ–•)
            case .ğŸ²:
                let ğŸ“¤ğŸ“ğŸ‘† = ğŸ› ï¸ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ²(ğŸ›«ğŸ—ºï¸[ğŸ‘†0][ğŸ–•0], ğŸ›«ğŸ—ºï¸[ğŸ‘†ğŸ‘‰1][ğŸ–•0], ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ‘†)
                let ğŸ“¤ğŸ“ğŸ–• = ğŸ› ï¸ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ²(ğŸ›«ğŸ—ºï¸[ğŸ‘†0][ğŸ–•ğŸ‘‰1], ğŸ›«ğŸ—ºï¸[ğŸ‘†ğŸ‘‰1][ğŸ–•ğŸ‘‰1], ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ‘†)
                ğŸ“¤ğŸ“ = ğŸ› ï¸ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ²(ğŸ“¤ğŸ“ğŸ‘†, ğŸ“¤ğŸ“ğŸ–•, ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ–•)
            case .ğŸ²ğŸ“:
                let ğŸ“¤ğŸ“ğŸ‘† = ğŸ› ï¸ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ²ğŸ“(ğŸ›«ğŸ—ºï¸[ğŸ‘†0][ğŸ–•0], ğŸ›«ğŸ—ºï¸[ğŸ‘†ğŸ‘‰1][ğŸ–•0], ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ‘†)
                let ğŸ“¤ğŸ“ğŸ–• = ğŸ› ï¸ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ²ğŸ“(ğŸ›«ğŸ—ºï¸[ğŸ‘†0][ğŸ–•ğŸ‘‰1], ğŸ›«ğŸ—ºï¸[ğŸ‘†ğŸ‘‰1][ğŸ–•ğŸ‘‰1], ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ‘†)
                ğŸ“¤ğŸ“ = ğŸ› ï¸ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ²ğŸ“(ğŸ“¤ğŸ“ğŸ‘†, ğŸ“¤ğŸ“ğŸ–•, ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ–•)
            case .ğŸ¢:
                let ğŸ“¤ğŸ“ğŸ‘† = ğŸ› ï¸ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ¢(ğŸ›«ğŸ—ºï¸[ğŸ‘†0][ğŸ–•0], ğŸ›«ğŸ—ºï¸[ğŸ‘†ğŸ‘‰1][ğŸ–•0], ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ‘†)
                let ğŸ“¤ğŸ“ğŸ–• = ğŸ› ï¸ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ¢(ğŸ›«ğŸ—ºï¸[ğŸ‘†0][ğŸ–•ğŸ‘‰1], ğŸ›«ğŸ—ºï¸[ğŸ‘†ğŸ‘‰1][ğŸ–•ğŸ‘‰1], ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ‘†)
                ğŸ“¤ğŸ“ = ğŸ› ï¸ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ¢(ğŸ“¤ğŸ“ğŸ‘†, ğŸ“¤ğŸ“ğŸ–•, ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ–•)
            case .ğŸ²ğŸ²:
                if (ğŸ‘† == 0 || ğŸ‘† >= ğŸ”²ğŸ“-2) && (ğŸ–• == 0 || ğŸ–• >= ğŸ”²ğŸ“-2)
                {
                    let ğŸ“¤ğŸ“ğŸ‘† = ğŸ› ï¸ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ¢(ğŸ›«ğŸ—ºï¸[ğŸ‘†0][ğŸ–•0], ğŸ›«ğŸ—ºï¸[ğŸ‘†ğŸ‘‰1][ğŸ–•0], ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ‘†)
                    let ğŸ“¤ğŸ“ğŸ–• = ğŸ› ï¸ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ¢(ğŸ›«ğŸ—ºï¸[ğŸ‘†0][ğŸ–•ğŸ‘‰1], ğŸ›«ğŸ—ºï¸[ğŸ‘†ğŸ‘‰1][ğŸ–•ğŸ‘‰1], ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ‘†)
                    ğŸ“¤ğŸ“ = ğŸ› ï¸ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ¢(ğŸ“¤ğŸ“ğŸ‘†, ğŸ“¤ğŸ“ğŸ–•, ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ–•)
                }
                else if ğŸ‘† == 0 || ğŸ‘† >= ğŸ”²ğŸ“-2
                {
                    let ğŸ“¤ğŸ“ğŸ‘† = ğŸ› ï¸ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ¢(ğŸ›«ğŸ—ºï¸[ğŸ‘†0][ğŸ–•ğŸ‘ˆ1], ğŸ›«ğŸ—ºï¸[ğŸ‘†ğŸ‘‰1][ğŸ–•ğŸ‘ˆ1], ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ‘†)
                    let ğŸ“¤ğŸ“ğŸ–• = ğŸ› ï¸ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ¢(ğŸ›«ğŸ—ºï¸[ğŸ‘†0][ğŸ–•0], ğŸ›«ğŸ—ºï¸[ğŸ‘†ğŸ‘‰1][ğŸ–•0], ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ‘†)
                    let ğŸ“¤ğŸ“ğŸ‘†ğŸ‘† = ğŸ› ï¸ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ¢(ğŸ›«ğŸ—ºï¸[ğŸ‘†0][ğŸ–•ğŸ‘‰1], ğŸ›«ğŸ—ºï¸[ğŸ‘†ğŸ‘‰1][ğŸ–•ğŸ‘‰1], ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ‘†)
                    let ğŸ“¤ğŸ“ğŸ–•ğŸ–• = ğŸ› ï¸ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ¢(ğŸ›«ğŸ—ºï¸[ğŸ‘†0][ğŸ–•ğŸ‘‰2], ğŸ›«ğŸ—ºï¸[ğŸ‘†ğŸ‘‰1][ğŸ–•ğŸ‘‰2], ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ‘†)
                    ğŸ“¤ğŸ“ = ğŸ› ï¸ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ²ğŸ²(ğŸ“¤ğŸ“ğŸ‘†, ğŸ“¤ğŸ“ğŸ–•, ğŸ“¤ğŸ“ğŸ‘†ğŸ‘†, ğŸ“¤ğŸ“ğŸ–•ğŸ–•, ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ‘†)
                }
                else if ğŸ–• == 0 || ğŸ–• >= ğŸ”²ğŸ“-2
                {
                    let ğŸ“¤ğŸ“ğŸ‘† = ğŸ› ï¸ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ²ğŸ²(ğŸ›«ğŸ—ºï¸[ğŸ‘†ğŸ‘ˆ1][ğŸ–•0], ğŸ›«ğŸ—ºï¸[ğŸ‘†0][ğŸ–•0], ğŸ›«ğŸ—ºï¸[ğŸ‘†ğŸ‘‰1][ğŸ–•0], ğŸ›«ğŸ—ºï¸[ğŸ‘†+2][ğŸ–•0], ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ‘†)
                    let ğŸ“¤ğŸ“ğŸ–• = ğŸ› ï¸ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ²ğŸ²(ğŸ›«ğŸ—ºï¸[ğŸ‘†ğŸ‘ˆ1][ğŸ–•ğŸ‘‰1], ğŸ›«ğŸ—ºï¸[ğŸ‘†][ğŸ–•ğŸ‘‰1], ğŸ›«ğŸ—ºï¸[ğŸ‘†ğŸ‘‰1][ğŸ–•ğŸ‘‰1], ğŸ›«ğŸ—ºï¸[ğŸ‘†+2][ğŸ–•ğŸ‘‰1], ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ‘†)
                    ğŸ“¤ğŸ“ = ğŸ› ï¸ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ¢(ğŸ“¤ğŸ“ğŸ‘†, ğŸ“¤ğŸ“ğŸ–•, ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ–•)
                }
                else
                {
                    let ğŸ“¤ğŸ“ğŸ‘† = ğŸ› ï¸ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ²ğŸ²(ğŸ›«ğŸ—ºï¸[ğŸ‘†ğŸ‘ˆ1][ğŸ–•ğŸ‘ˆ1], ğŸ›«ğŸ—ºï¸[ğŸ‘†0][ğŸ–•ğŸ‘ˆ1], ğŸ›«ğŸ—ºï¸[ğŸ‘†ğŸ‘‰1][ğŸ–•ğŸ‘ˆ1], ğŸ›«ğŸ—ºï¸[ğŸ‘†+2][ğŸ–•ğŸ‘ˆ1], ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ‘†)
                    let ğŸ“¤ğŸ“ğŸ–• = ğŸ› ï¸ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ²ğŸ²(ğŸ›«ğŸ—ºï¸[ğŸ‘†ğŸ‘ˆ1][ğŸ–•0], ğŸ›«ğŸ—ºï¸[ğŸ‘†0][ğŸ–•0], ğŸ›«ğŸ—ºï¸[ğŸ‘†ğŸ‘‰1][ğŸ–•0], ğŸ›«ğŸ—ºï¸[ğŸ‘†+2][ğŸ–•0], ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ‘†)
                    let ğŸ“¤ğŸ“ğŸ‘†ğŸ‘† = ğŸ› ï¸ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ²ğŸ²(ğŸ›«ğŸ—ºï¸[ğŸ‘†ğŸ‘ˆ1][ğŸ–•ğŸ‘‰1], ğŸ›«ğŸ—ºï¸[ğŸ‘†0][ğŸ–•ğŸ‘‰1], ğŸ›«ğŸ—ºï¸[ğŸ‘†ğŸ‘‰1][ğŸ–•ğŸ‘‰1], ğŸ›«ğŸ—ºï¸[ğŸ‘†+2][ğŸ–•ğŸ‘‰1], ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ‘†)
                    let ğŸ“¤ğŸ“ğŸ–•ğŸ–• = ğŸ› ï¸ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ²ğŸ²(ğŸ›«ğŸ—ºï¸[ğŸ‘†ğŸ‘ˆ1][ğŸ–•ğŸ‘‰2], ğŸ›«ğŸ—ºï¸[ğŸ‘†0][ğŸ–•ğŸ‘‰2], ğŸ›«ğŸ—ºï¸[ğŸ‘†ğŸ‘‰1][ğŸ–•ğŸ‘‰2], ğŸ›«ğŸ—ºï¸[ğŸ‘†+2][ğŸ–•ğŸ‘‰2], ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ‘†)
                    ğŸ“¤ğŸ“ = ğŸ› ï¸ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ²ğŸ²(ğŸ“¤ğŸ“ğŸ‘†, ğŸ“¤ğŸ“ğŸ–•, ğŸ“¤ğŸ“ğŸ‘†ğŸ‘†, ğŸ“¤ğŸ“ğŸ–•ğŸ–•, ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ‘†)
                }
        }
        
        return ğŸ“¤ğŸ“
    }
    
    static func ğŸ“ğŸ—ºï¸(_ ğŸ“¥ğŸ—ºï¸: [[Double]]) -> [[Double]]
    {
        var ğŸ“¤ğŸ—ºï¸ = ğŸ“¥ğŸ—ºï¸
        
        if ğŸ“¥ğŸ—ºï¸.count > 0
        {
            var ğŸ‘‡ğŸ“ = 1000000000.0
            var ğŸ‘†ğŸ“ = -1000000000.0
            
            for ğŸ‘† in 0..<ğŸ“¥ğŸ—ºï¸.count
            {
                for ğŸ–• in 0..<ğŸ“¥ğŸ—ºï¸[ğŸ‘†].count
                {
                    if ğŸ“¥ğŸ—ºï¸[ğŸ‘†][ğŸ–•] < ğŸ‘‡ğŸ“
                    {
                        ğŸ‘‡ğŸ“ = ğŸ“¥ğŸ—ºï¸[ğŸ‘†][ğŸ–•]
                    }
                    
                    if ğŸ“¥ğŸ—ºï¸[ğŸ‘†][ğŸ–•] > ğŸ‘†ğŸ“
                    {
                        ğŸ‘†ğŸ“ = ğŸ“¥ğŸ—ºï¸[ğŸ‘†][ğŸ–•]
                    }
                }
            }
            
            let ğŸ¤ = ğŸ‘†ğŸ“ - ğŸ‘‡ğŸ“
            
            for ğŸ‘† in 0..<ğŸ“¥ğŸ—ºï¸.count
            {
                for ğŸ–• in 0..<ğŸ“¥ğŸ—ºï¸[ğŸ‘†].count
                {
                    ğŸ“¤ğŸ—ºï¸[ğŸ‘†][ğŸ–•] = (ğŸ“¥ğŸ—ºï¸[ğŸ‘†][ğŸ–•]-ğŸ‘‡ğŸ“)/ğŸ¤
                }
            }
        }
        
        return ğŸ“¤ğŸ—ºï¸
    }
    
    func ğŸ› ï¸ğŸ²ğŸ—ºï¸()
    {
        ğŸ›«ğŸ—ºï¸ = []
            
        for _ in 0..<ğŸ”²ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ“
        {
            var ğŸ›«ğŸ—ºï¸ğŸ“: [Double] = []
            
            for _ in 0..<ğŸ”²ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ“
            {
                ğŸ›«ğŸ—ºï¸ğŸ“.append(Double.random(in: 0..<1))
            }
                
            ğŸ›«ğŸ—ºï¸.append(ğŸ›«ğŸ—ºï¸ğŸ“)
        }
    }
}

class ğŸ²ğŸ—ºï¸: ğŸ”ï¸ğŸ—ºï¸
{
    var ğŸ”²ğŸ¼ = 5
    var ğŸª¨ = 0.5
    var ğŸ—ºï¸ğŸ—ºï¸: [ğŸ”ï¸ğŸ—ºï¸] = []
    
    var ğŸ§®ğŸ²ğŸ—ºï¸ = 0
    
    @objc func ğŸ› ï¸ğŸ²ğŸ—ºï¸ğŸ‘†(ğŸ–•: [Int])
    {
        let ğŸ—ºï¸ = ğŸ”ï¸ğŸ—ºï¸()
        ğŸ—ºï¸.ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸšï¸ = self.ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸšï¸
        let ğŸ–•ğŸ–• = Int(pow(2.0, Double(ğŸ–•[0])))
        ğŸ—ºï¸.ğŸ”²ğŸ“ = self.ğŸ”²ğŸ“*ğŸ–•ğŸ–•
        ğŸ—ºï¸.ğŸ”²ğŸ“ = self.ğŸ”²ğŸ“*ğŸ–•ğŸ–•
        ğŸ—ºï¸.ğŸ”²ğŸ”ï¸ğŸ“ğŸ”ï¸ = self.ğŸ”²ğŸ”ï¸ğŸ“ğŸ”ï¸/ğŸ–•ğŸ–•
        ğŸ—ºï¸.ğŸ› ï¸ğŸ²ğŸ—ºï¸()
        self.ğŸ—ºï¸ğŸ—ºï¸[ğŸ–•[0]] = ğŸ—ºï¸
            
        self.ğŸ§®ğŸ²ğŸ—ºï¸ += 1
    }
    
    override func ğŸ› ï¸ğŸ²ğŸ—ºï¸()
    {
        ğŸ§®ğŸ²ğŸ—ºï¸ = 0
        
        ğŸ—ºï¸ğŸ—ºï¸ = [ğŸ”ï¸ğŸ—ºï¸](repeating: ğŸ”ï¸ğŸ—ºï¸(), count: ğŸ”²ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ“)
        
        for ğŸ‘† in 0..<ğŸ”²ğŸ¼
        {
            let ğŸï¸ = Thread(target: self, selector: #selector(ğŸ› ï¸ğŸ²ğŸ—ºï¸ğŸ‘†(ğŸ–•:)), object: [ğŸ‘†])
            ğŸï¸.start()
        }
        
        while ğŸ§®ğŸ²ğŸ—ºï¸ < ğŸ”²ğŸ¼
        {
            ğŸ‘©â€ğŸ¦½ğŸ«™()
        }
    }
    
    func ğŸ› ï¸ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ‘†(_ ğŸ‘†: Int)
    {
        ğŸ”ï¸ğŸ—ºï¸.ğŸ“ğŸ“ğŸ”ï¸ğŸ“ğŸ”ï¸.async
        {
            for ğŸ–• in 0..<self.ğŸ”²ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ“
            {
                self.ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ—ºï¸[ğŸ‘†][ğŸ–•] = self.ğŸ› ï¸(Double(ğŸ‘†), Double(ğŸ–•))
            }
            
            ğŸ”ï¸ğŸ—ºï¸.ğŸ§®ğŸ”ï¸ğŸ“ğŸ”ï¸ += 1
        }
    }
    
    @objc func ğŸ› ï¸ğŸ¼(ğŸ‘†ğŸ¼: [Int])
    {
        ğŸ—ºï¸ğŸ—ºï¸[ğŸ‘†ğŸ¼[0]].ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ—ºï¸ = []
        
        for _ in 0..<ğŸ”²ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ“
        {
            let ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ—ºï¸ğŸ“ = [Double](repeating: 0.0, count: ğŸ”²ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ“)
            ğŸ—ºï¸ğŸ—ºï¸[ğŸ‘†ğŸ¼[0]].ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ—ºï¸.append(ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ—ºï¸ğŸ“)
        }
        
        for ğŸ‘† in 0..<ğŸ”²ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ“
        {
            for ğŸ–• in 0..<self.ğŸ”²ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ“
            {
                ğŸ—ºï¸ğŸ—ºï¸[ğŸ‘†ğŸ¼[0]].ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ—ºï¸[ğŸ‘†][ğŸ–•] = ğŸ—ºï¸ğŸ—ºï¸[ğŸ‘†ğŸ¼[0]].ğŸ› ï¸(Double(ğŸ‘†), Double(ğŸ–•))
            }
        }
        
        ğŸ—ºï¸ğŸ—ºï¸[ğŸ‘†ğŸ¼[0]].ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ—ºï¸ = ğŸ”ï¸ğŸ—ºï¸.ğŸ“ğŸ—ºï¸(ğŸ—ºï¸ğŸ—ºï¸[ğŸ‘†ğŸ¼[0]].ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ—ºï¸)
        
        ğŸ§®ğŸ²ğŸ—ºï¸ += 1
    }
    
    override func ğŸ› ï¸ğŸ”ï¸ğŸ“ğŸ”ï¸()
    {
        ğŸ§®ğŸ²ğŸ—ºï¸ = 0
        
        for ğŸ‘† in 0..<ğŸ”²ğŸ¼
        {
            let ğŸï¸ = Thread(target: self, selector: #selector(ğŸ› ï¸ğŸ¼(ğŸ‘†ğŸ¼:)), object: [ğŸ‘†])
            ğŸï¸.start()
        }
        
        while ğŸ§®ğŸ²ğŸ—ºï¸ < ğŸ”²ğŸ¼
        {
            ğŸ‘©â€ğŸ¦½ğŸ«™()
        }
        
        ğŸ”ï¸ğŸ—ºï¸.ğŸ“ğŸ“ğŸ”ï¸ğŸ“ğŸ”ï¸ = DispatchQueue(label: "ğŸ“ğŸ”ï¸ğŸ“")
        ğŸ”ï¸ğŸ—ºï¸.ğŸ§®ğŸ”ï¸ğŸ“ğŸ”ï¸ = 0
        
        ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ—ºï¸ = []
        
        for _ in 0..<ğŸ”²ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ“
        {
            let ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ—ºï¸ğŸ“ = [Double](repeating: 0.0, count: ğŸ”²ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ“)
            ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ—ºï¸.append(ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ—ºï¸ğŸ“)
        }
        
        for ğŸ‘† in 0..<ğŸ”²ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ“
        {
            ğŸ› ï¸ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ‘†(ğŸ‘†)
        }
        
        while ğŸ”ï¸ğŸ—ºï¸.ğŸ§®ğŸ”ï¸ğŸ“ğŸ”ï¸ < ğŸ”²ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ“
        {
            ğŸ‘©â€ğŸ¦½ğŸ«™()
        }
        
        ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ—ºï¸ = ğŸ”ï¸ğŸ—ºï¸.ğŸ“ğŸ—ºï¸(ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ—ºï¸)
    }
    
    override func ğŸ› ï¸(_ ğŸ“¥ğŸ“ğŸ‘†: Double, _ ğŸ“¥ğŸ“ğŸ–•: Double) -> Double
    {
        var ğŸ“¤ğŸ“: Double = 0.0
        var ğŸ‘†ğŸ“ = 1.0
        var ğŸ“Œ = 0.0
        
        if ğŸ—ºï¸ğŸ—ºï¸.count > 0
        {
            for ğŸ‘† in 0..<ğŸ”²ğŸ¼
            {
                let ğŸ—ºï¸ = ğŸ—ºï¸ğŸ—ºï¸[ğŸ‘†]
                
                if Int(ğŸ“¥ğŸ“ğŸ‘†) < ğŸ—ºï¸.ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ—ºï¸.count && Int(ğŸ“¥ğŸ“ğŸ–•) < ğŸ—ºï¸.ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ—ºï¸[Int(ğŸ“¥ğŸ“ğŸ‘†)].count
                {
                    ğŸ“Œ = ğŸ“Œ + ğŸ—ºï¸.ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ—ºï¸[Int(ğŸ“¥ğŸ“ğŸ‘†)][Int(ğŸ“¥ğŸ“ğŸ–•)]*pow(ğŸª¨, Double(ğŸ‘†))
                }
            }
            
            ğŸ‘†ğŸ“ = (1.0 - pow(ğŸª¨, Double(ğŸ—ºï¸ğŸ—ºï¸.count)))/(1.0 - ğŸª¨)
            ğŸ“¤ğŸ“ = ğŸ“Œ/ğŸ‘†ğŸ“
        }
        
        return ğŸ“¤ğŸ“
    }
}
