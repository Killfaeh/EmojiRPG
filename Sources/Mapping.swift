//
//  Mapping.swift
//  EmojiRPG
//
//  Created by Suisei killfaeh on 27/12/2024.
//

import Foundation
import CoreImage

let ğŸ–¥ï¸ğŸ“ = [38,24]

class ğŸŒğŸ§©
{
    var ğŸ·ï¸ = "ğŸŒğŸ§©"
    var ğŸï¸ = ğŸŸ©
    var ğŸ•ï¸ = ğŸ’¨+ğŸ’¨
    var ğŸš· = ğŸ‘
    var ğŸï¸ = ğŸ‘
    var ğŸ‘‰ğŸï¸ = ğŸ‘
    
    init(_ ğŸï¸: String, _ ğŸ•ï¸: String)
    {
        self.ğŸï¸ = ğŸï¸
        self.ğŸ•ï¸ = ğŸ•ï¸
    }
    
    func ğŸ²ğŸï¸ğŸ‘‰ğŸ–¥ï¸()
    {
        if ğŸï¸ == ğŸ‘
        {
            if Int.random(in: 0...1) < 1
            {
                ğŸ‘‰ğŸï¸ = ğŸ‘
            }
            else
            {
                ğŸ‘‰ğŸï¸ = ğŸ‘
            }
        }
    }
    
    func ğŸ‘‰ğŸ–¥ï¸() -> String
    {
        var ğŸ“¤ = ğŸï¸ + ğŸ•ï¸ + ğŸŸ«
        
        if ğŸï¸ == ğŸ‘ && ğŸ‘‰ğŸï¸
        {
            ğŸ“¤ = ğŸï¸ + ğŸ’¨ + ğŸ’¨ + ğŸŸ«
        }
        
        return ğŸ“¤
    }
    
    func ğŸ‘‰ğŸ’¾() -> [Any]
    {
        let ğŸ—‚ï¸: [Any] = [ ğŸ·ï¸, ğŸï¸, ğŸ•ï¸, ğŸš·, ğŸï¸ ]
        return ğŸ—‚ï¸
    }
}

class ğŸŒğŸ§©ğŸš·: ğŸŒğŸ§©
{
    override init(_ ğŸï¸: String, _ ğŸ•ï¸: String)
    {
        super.init(ğŸï¸, ğŸ•ï¸)
        ğŸš· = ğŸ‘
    }
}

class ğŸŒŠ: ğŸŒğŸ§©ğŸš·
{
    var ğŸ‘† = 0
    var ğŸ–• = 0
    var ğŸï¸ğŸ‘† = 0
    
    override func ğŸ²ğŸï¸ğŸ‘‰ğŸ–¥ï¸()
    {
        if ğŸï¸ğŸ‘†%3 == 0
        {
            if (ğŸ–•%2 == 0 && ğŸ‘†%3 == 0) || (ğŸ–•%2 != 0 && ğŸ‘†%3 != 0)
            {
                ğŸ‘‰ğŸï¸ = ğŸ‘
            }
            else if (ğŸ–•%2 == 0 && ğŸ‘†%3 != 0) || (ğŸ–•%2 != 0 && ğŸ‘†%3 == 0)
            {
                ğŸ‘‰ğŸï¸ = ğŸ‘
            }
        }
        else if ğŸï¸ğŸ‘†%3 == 1
        {
            if (ğŸ–•%2 == 0 && ğŸ‘†%3 == 1) || (ğŸ–•%2 != 0 && ğŸ‘†%3 != 1)
            {
                ğŸ‘‰ğŸï¸ = ğŸ‘
            }
            else if (ğŸ–•%2 == 0 && ğŸ‘†%3 != 1) || (ğŸ–•%2 != 0 && ğŸ‘†%3 == 1)
            {
                ğŸ‘‰ğŸï¸ = ğŸ‘
            }
        }
        else if ğŸï¸ğŸ‘†%3 == 2
        {
            if (ğŸ–•%2 == 0 && ğŸ‘†%3 == 2) || (ğŸ–•%2 != 0 && ğŸ‘†%3 != 2)
            {
                ğŸ‘‰ğŸï¸ = ğŸ‘
            }
            else if (ğŸ–•%2 == 0 && ğŸ‘†%3 != 2) || (ğŸ–•%2 != 0 && ğŸ‘†%3 == 2)
            {
                ğŸ‘‰ğŸï¸ = ğŸ‘
            }
        }
        
        ğŸï¸ğŸ‘† += 1
    }
    
    override init(_ ğŸï¸: String, _ ğŸ•ï¸: String)
    {
        super.init(ğŸï¸, ğŸ•ï¸)
        ğŸï¸ = ğŸ‘
    }
}

class ğŸŒ
{
    internal var ğŸŒğŸ§©ğŸ§©ğŸ§©: [[ğŸŒğŸ§©]] = []
    internal var ğŸ—‚ï¸ğŸ—‚ï¸ğŸ—‚ï¸: [[[Any]]] = []
    private var ğŸ·ï¸ = "world"
    private let ğŸ§· = "bmp"
    private var ğŸŒğŸ“: String
    var ğŸ”„ = ğŸ‘
    var ğŸ§®ğŸ—ï¸ = 0
    var ğŸ§®ğŸ’¾ = 0
    var ğŸ§®ğŸï¸ = 0
    
    var ğŸ“ğŸ“ğŸ—ï¸ = DispatchQueue(label: "ğŸ—ï¸")
    var ğŸ“ğŸ“ğŸ’¾ = DispatchQueue(label: "ğŸ’¾")
    var ğŸ“ğŸ“ğŸï¸ = DispatchQueue(label: "ğŸï¸")
    
    var ğŸ—ºï¸ğŸ“: Int
    {
        get
        {
            return ğŸŒğŸ§©ğŸ§©ğŸ§©.count
        }
    }
    
    var ğŸ—ºï¸ğŸ“: Int
    {
        get
        {
            return ğŸŒğŸ§©ğŸ§©ğŸ§©[0].count
        }
    }
    
    init()
    {
        ğŸŒğŸ“ = "Resources/maps/" + ğŸ·ï¸ + "." + ğŸ§·
    }
    
    private func ğŸ’¾ğŸ—ï¸()
    {
        let ğŸ–¼ï¸ = ğŸ–¼ï¸ğŸ—ºï¸(ğŸŒğŸ“)
        ğŸ–¼ï¸.ğŸ—ï¸()
    }
    
    func ğŸ—ï¸()
    {        
        ğŸŒğŸ“ = ğŸ”ğŸ“("maps", ğŸ·ï¸, ğŸ§·)
        ğŸ’¾ğŸ—ï¸()
    }
    
    func ğŸ—ï¸ğŸ‘†(_ ğŸ‘†: Int, _ ğŸ—‚ï¸ğŸ—‚ï¸: [[Any]])
    {
        ğŸ“ğŸ“ğŸ—ï¸.async
        {
            var ğŸ–• = 0
            
            for ğŸ—‚ï¸ in ğŸ—‚ï¸ğŸ—‚ï¸
            {
                var ğŸ§© = ğŸŒğŸ§©(ğŸ«™, ğŸ«™)
                    
                if let ğŸ·ï¸: String = ğŸ—‚ï¸[0] as? String
                {
                    ğŸ§©.ğŸ·ï¸ =  ğŸ·ï¸
                }
                    
                if let ğŸ·ï¸: String = ğŸ—‚ï¸[1] as? String
                {
                    ğŸ§©.ğŸï¸ =  ğŸ·ï¸
                        
                    if ğŸ·ï¸ == "\u{001B}[48;5;21m" || ğŸ·ï¸ == "\u{001B}[48;5;39m"
                    {
                        let ğŸŒŠğŸ§© = ğŸŒŠ(ğŸ·ï¸, ğŸ«™)
                        ğŸŒŠğŸ§©.ğŸ‘† = ğŸ–•
                        ğŸŒŠğŸ§©.ğŸ–• = ğŸ‘†
                        ğŸ§© = ğŸŒŠğŸ§©
                    }
                }
                    
                if let ğŸ·ï¸: String = ğŸ—‚ï¸[2] as? String
                {
                    ğŸ§©.ğŸ•ï¸ =  ğŸ·ï¸
                }
                    
                if let ğŸ·ï¸: Bool = ğŸ—‚ï¸[3] as? Bool
                {
                    ğŸ§©.ğŸš· =  ğŸ·ï¸
                }
                    
                if let ğŸ·ï¸: Bool = ğŸ—‚ï¸[4] as? Bool
                {
                    ğŸ§©.ğŸï¸ =  ğŸ·ï¸
                }
                    
                self.ğŸŒğŸ§©ğŸ§©ğŸ§©[ğŸ‘†][ğŸ–•] = ğŸ§©
                
                ğŸ–• += 1
            }
            
            self.ğŸ§®ğŸ—ï¸ += 1
        }
    }
    
    func ğŸ—ï¸(_ ğŸ—‚ï¸ğŸ—‚ï¸ğŸ—‚ï¸: [[[Any]]])
    {
        ğŸ“ğŸ“ğŸ—ï¸ = DispatchQueue(label: "ğŸ—ï¸")
        
        ğŸŒğŸ§©ğŸ§©ğŸ§© = []
        
        for ğŸ‘† in 0..<ğŸ—‚ï¸ğŸ—‚ï¸ğŸ—‚ï¸.count
        {
            let ğŸŒğŸ§©ğŸ§© = [ğŸŒğŸ§©](repeating: ğŸŒğŸ§©(ğŸ«™, ğŸ«™), count: ğŸ—‚ï¸ğŸ—‚ï¸ğŸ—‚ï¸[ğŸ‘†].count)
            ğŸŒğŸ§©ğŸ§©ğŸ§©.append(ğŸŒğŸ§©ğŸ§©)
        }
        
        var ğŸ‘† = 0
        ğŸ§®ğŸ—ï¸ = 0
        
        for ğŸ—‚ï¸ğŸ—‚ï¸ in ğŸ—‚ï¸ğŸ—‚ï¸ğŸ—‚ï¸
        {
            ğŸ—ï¸ğŸ‘†(ğŸ‘†, ğŸ—‚ï¸ğŸ—‚ï¸)
            ğŸ‘† += 1
        }
        
        while ğŸ§®ğŸ—ï¸ < ğŸ—‚ï¸ğŸ—‚ï¸ğŸ—‚ï¸.count
        {
            ğŸ‘©â€ğŸ¦½ğŸ«™()
        }
    }
    
    func ğŸ‘‰ğŸ–¥ï¸(_ ğŸ“: Int, _ ğŸ“: Int, _ ğŸ­ğŸ­: [[String]]) -> String
    {
        var ğŸ“¤ = ğŸ«™
        
        var ğŸ“ğŸ“ = ğŸ“ - ğŸ–¥ï¸ğŸ“[0]/2
        var ğŸ“ğŸ“ = ğŸ“ - ğŸ–¥ï¸ğŸ“[1]/2
        
        if ğŸ”„ == ğŸ‘
        {
            if ğŸ“ğŸ“ < 0
            {
                ğŸ“ğŸ“ = 0
            }
            else if ğŸ“ğŸ“ + ğŸ–¥ï¸ğŸ“[0] > ğŸŒğŸ§©ğŸ§©ğŸ§©[0].count
            {
                ğŸ“ğŸ“ = ğŸŒğŸ§©ğŸ§©ğŸ§©[0].count - ğŸ–¥ï¸ğŸ“[0]
            }
            
            if ğŸ“ğŸ“ < 0
            {
                ğŸ“ğŸ“ = 0
            }
            else if ğŸ“ğŸ“ + ğŸ–¥ï¸ğŸ“[1] > ğŸŒğŸ§©ğŸ§©ğŸ§©.count
            {
                ğŸ“ğŸ“ = ğŸŒğŸ§©ğŸ§©ğŸ§©.count - ğŸ–¥ï¸ğŸ“[1]
            }
        }
        
        for ğŸ‘† in 0..<ğŸ–¥ï¸ğŸ“[1]
        {
            var ğŸ“ŒğŸ“ = ğŸ“ğŸ“ + ğŸ‘†
            
            if  ğŸ”„ == ğŸ‘
            {
                if ğŸ“ŒğŸ“ < 0
                {
                    ğŸ“ŒğŸ“ = ğŸŒğŸ§©ğŸ§©ğŸ§©.count + ğŸ“ŒğŸ“
                }
                else if ğŸ“ŒğŸ“ >= ğŸŒğŸ§©ğŸ§©ğŸ§©.count
                {
                    ğŸ“ŒğŸ“ = ğŸ“ŒğŸ“ - ğŸŒğŸ§©ğŸ§©ğŸ§©.count
                }
            }
            
            let ğŸŒğŸ§©ğŸ§© = ğŸŒğŸ§©ğŸ§©ğŸ§©[ğŸ“ŒğŸ“]
            
            if ğŸ‘† > 0
            {
                ğŸ“¤ = ğŸ“¤ + ğŸª‚
            }
            
            ğŸ“¤ = ğŸ“¤ + ğŸ’¨ + ğŸ’¨
            
            for ğŸ–• in 0..<ğŸ–¥ï¸ğŸ“[0]
            {
                var ğŸ“ŒğŸ“ = ğŸ“ğŸ“ + ğŸ–•
                
                if  ğŸ”„ == ğŸ‘
                {
                    if ğŸ“ŒğŸ“ < 0
                    {
                        ğŸ“ŒğŸ“ = ğŸŒğŸ§©ğŸ§©.count + ğŸ“ŒğŸ“
                    }
                    else if ğŸ“ŒğŸ“ >= ğŸŒğŸ§©ğŸ§©.count
                    {
                        ğŸ“ŒğŸ“ = ğŸ“ŒğŸ“ - ğŸŒğŸ§©ğŸ§©.count
                    }
                }
                
                let ğŸ”  = ğŸ­ğŸ­[ğŸ‘†][ğŸ–•]
                
                if ğŸ”  == "â¬›ï¸"
                {
                    ğŸ“¤ = ğŸ“¤ + ğŸŒğŸ§©ğŸ§©[ğŸ“ŒğŸ“].ğŸ‘‰ğŸ–¥ï¸()
                }
                else
                {
                    ğŸ“¤ = ğŸ“¤ + ğŸ” 
                }
            }
        }
        
        return ğŸ“¤
    }
    
    func ğŸ‘‰ğŸ’¾ğŸ‘†(_ ğŸ‘†: Int)
    {
        ğŸ“ğŸ“ğŸ’¾.async
        {
            for ğŸ–• in 0..<self.ğŸŒğŸ§©ğŸ§©ğŸ§©[ğŸ‘†].count
            {
                self.ğŸ—‚ï¸ğŸ—‚ï¸ğŸ—‚ï¸[ğŸ‘†][ğŸ–•] = self.ğŸŒğŸ§©ğŸ§©ğŸ§©[ğŸ‘†][ğŸ–•].ğŸ‘‰ğŸ’¾()
            }
            
            self.ğŸ§®ğŸ’¾ += 1
        }
    }
    
    func ğŸ‘‰ğŸ’¾() -> [[[Any]]]
    {
        ğŸ“ğŸ“ğŸ’¾ = DispatchQueue(label: "ğŸ’¾")
        
        ğŸ—‚ï¸ğŸ—‚ï¸ğŸ—‚ï¸ = []
        ğŸ§®ğŸ’¾ = 0
        
        for ğŸ‘† in 0..<ğŸŒğŸ§©ğŸ§©ğŸ§©.count
        {
            let ğŸ—‚ï¸ğŸ—‚ï¸ = [[Any]](repeating: [], count: ğŸŒğŸ§©ğŸ§©ğŸ§©[ğŸ‘†].count)
            ğŸ—‚ï¸ğŸ—‚ï¸ğŸ—‚ï¸.append(ğŸ—‚ï¸ğŸ—‚ï¸)
        }
        
        for ğŸ‘† in 0..<ğŸŒğŸ§©ğŸ§©ğŸ§©.count
        {
            ğŸ‘‰ğŸ’¾ğŸ‘†(ğŸ‘†)
        }
        
        while ğŸ§®ğŸ’¾ < ğŸŒğŸ§©ğŸ§©ğŸ§©.count
        {
            ğŸ‘©â€ğŸ¦½ğŸ«™()
        }
        
        return ğŸ—‚ï¸ğŸ—‚ï¸ğŸ—‚ï¸
    }
    
    func ğŸ”²ğŸš·(_ ğŸ‘†: Int, _ ğŸ–•: Int) -> Bool
    {
        var ğŸ‘†ğŸ‘† = ğŸ‘†
        var ğŸ–•ğŸ–• = ğŸ–•
        
        if ğŸ‘† < 0
        {
            ğŸ‘†ğŸ‘† = ğŸŒğŸ§©ğŸ§©ğŸ§©[0].count-1
        }
        else if ğŸ‘† >= ğŸŒğŸ§©ğŸ§©ğŸ§©[0].count
        {
            ğŸ‘†ğŸ‘† = 0
        }
        
        if ğŸ–• < 0
        {
            ğŸ–•ğŸ–• = ğŸŒğŸ§©ğŸ§©ğŸ§©.count-1
        }
        else if ğŸ–• >= ğŸŒğŸ§©ğŸ§©ğŸ§©.count
        {
            ğŸ–•ğŸ–• = 0
        }
        
        return ğŸŒğŸ§©ğŸ§©ğŸ§©[ğŸ–•ğŸ–•][ğŸ‘†ğŸ‘†].ğŸš·
    }
    
    func ğŸ²ğŸï¸ğŸ‘‰ğŸ–¥ï¸()
    {
        for ğŸŒğŸ§©ğŸ§© in ğŸŒğŸ§©ğŸ§©ğŸ§©
        {
            for ğŸ§© in ğŸŒğŸ§©ğŸ§©
            {
                if let ğŸŒŠğŸ§© = ğŸ§© as? ğŸŒŠ
                {
                    ğŸŒŠğŸ§©.ğŸ²ğŸï¸ğŸ‘‰ğŸ–¥ï¸()
                }
            }
        }
    }
}

class ğŸ²ğŸŒ: ğŸŒ
{
    var ğŸ“ = 40
    var ğŸ“ = 24
    var ğŸ”ï¸ğŸ—ºï¸ğŸ—ºï¸ = ğŸ²ğŸ—ºï¸()
    
    var ğŸ§®ğŸ² = 0
    var ğŸ“ğŸ“ğŸ² = DispatchQueue(label: "ğŸ²")
    
    let ğŸ¨ğŸ¨ =
    [
        "\u{001B}[48;5;21m", "\u{001B}[48;5;21m", "\u{001B}[48;5;21m", "\u{001B}[48;5;21m", "\u{001B}[48;5;21m", "\u{001B}[48;5;21m", "\u{001B}[48;5;21m", "\u{001B}[48;5;21m", "\u{001B}[48;5;21m", "\u{001B}[48;5;21m", "\u{001B}[48;5;21m",
        "\u{001B}[48;5;39m",
        "\u{001B}[48;5;51m",
        
        "\u{001B}[48;5;229m",
        "\u{001B}[48;5;221m",
        
        "\u{001B}[48;5;154m", "\u{001B}[48;5;154m",
        "\u{001B}[48;5;82m", "\u{001B}[48;5;82m", "\u{001B}[48;5;82m", "\u{001B}[48;5;82m", "\u{001B}[48;5;82m",
        "\u{001B}[48;5;40m", "\u{001B}[48;5;40m", "\u{001B}[48;5;40m", "\u{001B}[48;5;40m", "\u{001B}[48;5;40m",
        "\u{001B}[48;5;76m",
        
        "\u{001B}[48;5;142m",
        
        "\u{001B}[48;5;145m", "\u{001B}[48;5;145m", "\u{001B}[48;5;145m",
        "\u{001B}[48;5;254m", "\u{001B}[48;5;254m", "\u{001B}[48;5;254m",
        "\u{001B}[48;5;15m", "\u{001B}[48;5;15m", "\u{001B}[48;5;15m"
    ]
    
    let ğŸ¨ğŸ•ï¸ğŸ•ï¸ =
    [
        "\u{001B}[48;5;21m": [ "ğŸŒŠ" ],
        "\u{001B}[48;5;39m": [ ğŸ’¨ + ğŸ’¨, ğŸ’¨ + ğŸ’¨, ğŸ’¨ + ğŸ’¨, ğŸ’¨ + ğŸ’¨, ğŸ’¨ + ğŸ’¨, "ğŸŒŠ", "ğŸŒŠ", "ğŸŒŠ", "ğŸŒŠ", "ğŸŒŠ"],
        "\u{001B}[48;5;51m": [ ğŸ’¨ + ğŸ’¨, ğŸ’¨ + ğŸ’¨, ğŸ’¨ + ğŸ’¨, ğŸ’¨ + ğŸ’¨, ğŸ’¨ + ğŸ’¨, ğŸ’¨ + ğŸ’¨, "ğŸï¸" + ğŸ’¨ ],
        
        "\u{001B}[48;5;229m": [ ğŸ’¨ + ğŸ’¨, ğŸ’¨ + ğŸ’¨, ğŸ’¨ + ğŸ’¨, ğŸ’¨ + ğŸ’¨, "ğŸŒ´" ],
        "\u{001B}[48;5;221m": [ ğŸ’¨ + ğŸ’¨, ğŸ’¨ + ğŸ’¨, ğŸ’¨ + ğŸ’¨, ğŸ’¨ + ğŸ’¨, ğŸ’¨ + ğŸ’¨, "ğŸŒ¾", "ğŸŒ´", "ğŸŒµ", "ğŸŒµ" ],
        
        "\u{001B}[48;5;154m": [ ğŸ’¨ + ğŸ’¨, ğŸ’¨ + ğŸ’¨, ğŸ’¨ + ğŸ’¨, ğŸ’¨ + ğŸ’¨, "ğŸŒ¾", "ğŸŒ³", "ğŸŒ´" ],
        "\u{001B}[48;5;82m" : [ ğŸ’¨ + ğŸ’¨, ğŸ’¨ + ğŸ’¨, ğŸ’¨ + ğŸ’¨, ğŸ’¨ + ğŸ’¨, ğŸ’¨ + ğŸ’¨, ğŸ’¨ + ğŸ’¨, ğŸ’¨ + ğŸ’¨, ğŸ’¨ + ğŸ’¨, ğŸ’¨ + ğŸ’¨, ğŸ’¨ + ğŸ’¨, ğŸ’¨ + ğŸ’¨, ğŸ’¨ + ğŸ’¨, 
                                ğŸ’¨ + ğŸ’¨, ğŸ’¨ + ğŸ’¨, ğŸ’¨ + ğŸ’¨, ğŸ’¨ + ğŸ’¨, ğŸ’¨ + ğŸ’¨, ğŸ’¨ + ğŸ’¨, ğŸ’¨ + ğŸ’¨, "ğŸ„",  "ğŸŒ±",
                                "ğŸŒ³", "ğŸŒ³", "ğŸŒ³", "ğŸŒ³", "ğŸŒ³", "ğŸŒ³", "ğŸŒ³", "ğŸŒ³", "ğŸŒ³", "ğŸŒ³", "ğŸŒ³", "ğŸŒ³", "ğŸŒ³", "ğŸŒ³", "ğŸŒ³", 
                                "ğŸŒ²", "ğŸŒ²", "ğŸŒ²", "ğŸŒ²", "ğŸŒ²", "ğŸŒ²" ],
        "\u{001B}[48;5;40m": [ ğŸ’¨ + ğŸ’¨, ğŸ’¨ + ğŸ’¨, ğŸ’¨ + ğŸ’¨, ğŸ’¨ + ğŸ’¨, ğŸ’¨ + ğŸ’¨, ğŸ’¨ + ğŸ’¨, ğŸ’¨ + ğŸ’¨, ğŸ’¨ + ğŸ’¨, ğŸ’¨ + ğŸ’¨, ğŸ’¨ + ğŸ’¨, ğŸ’¨ + ğŸ’¨, ğŸ’¨ + ğŸ’¨,
                               ğŸ’¨ + ğŸ’¨, ğŸ’¨ + ğŸ’¨, ğŸ’¨ + ğŸ’¨, ğŸ’¨ + ğŸ’¨, ğŸ’¨ + ğŸ’¨, ğŸ’¨ + ğŸ’¨, ğŸ’¨ + ğŸ’¨, "ğŸ„", "ğŸŒ¿",
                               "ğŸŒ³", "ğŸŒ³", "ğŸŒ³", "ğŸŒ³", "ğŸŒ³", "ğŸŒ³", 
                               "ğŸŒ²", "ğŸŒ²", "ğŸŒ²", "ğŸŒ²", "ğŸŒ²", "ğŸŒ²", "ğŸŒ²", "ğŸŒ²", "ğŸŒ²", "ğŸŒ²", "ğŸŒ²", "ğŸŒ²", "ğŸŒ²", "ğŸŒ²", "ğŸŒ²" ],
        "\u{001B}[48;5;76m": [ ğŸ’¨ + ğŸ’¨, ğŸ’¨ + ğŸ’¨, ğŸ’¨ + ğŸ’¨, "ğŸŒ²", "ğŸŒ²" ],
        
        "\u{001B}[48;5;142m": [ ğŸ’¨ + ğŸ’¨, ğŸ’¨ + ğŸ’¨, ğŸ’¨ + ğŸ’¨, ğŸ’¨ + ğŸ’¨, "ğŸŒ²", "ğŸŒ²", "â›°ï¸" + ğŸ’¨ ],
        
        "\u{001B}[48;5;145m": [ ğŸ’¨ + ğŸ’¨, "â›°ï¸" + ğŸ’¨, "â›°ï¸" + ğŸ’¨, "â›°ï¸" + ğŸ’¨, "â›°ï¸" + ğŸ’¨ ],
        "\u{001B}[48;5;254m": [ ğŸ’¨ + ğŸ’¨, "â›°ï¸" + ğŸ’¨, "â›°ï¸" + ğŸ’¨, "â›°ï¸" + ğŸ’¨, "â›°ï¸" + ğŸ’¨, "ğŸ”ï¸" + ğŸ’¨, "ğŸ”ï¸" + ğŸ’¨, "ğŸ”ï¸" + ğŸ’¨, "ğŸ”ï¸" + ğŸ’¨ ],
        "\u{001B}[48;5;15m": [ "ğŸ”ï¸" + ğŸ’¨, "ğŸ—»" ]
    ]
    
    init(_ ğŸ“: Int, _ ğŸ“: Int)
    {
        super.init()
        self.ğŸ“ = ğŸ“
        self.ğŸ“ = ğŸ“
        ğŸ”„ = ğŸ‘
    }
    
    func ğŸ› ï¸ğŸ”ï¸ğŸ—ºï¸() -> [[Double]]
    {
        let ğŸ”²ğŸ¼ = 5
        let ğŸ”²ğŸ”ï¸ğŸ“ğŸ”ï¸ = 2
        
        if ğŸ“%Int(pow(2.0, Double(ğŸ”²ğŸ¼))) != 0
        {
            let ğŸ“Œ = Int(Double(ğŸ“)/pow(2.0, Double(ğŸ”²ğŸ¼))) * Int(pow(2.0, Double(ğŸ”²ğŸ¼)))
            ğŸ“ = ğŸ“Œ*ğŸ”²ğŸ”ï¸ğŸ“ğŸ”ï¸
        }
        
        if ğŸ“%Int(pow(2.0, Double(ğŸ”²ğŸ¼))) != 0
        {
            let ğŸ“Œ = Int(Double(ğŸ“)/pow(2.0, Double(ğŸ”²ğŸ¼))) * Int(pow(2.0, Double(ğŸ”²ğŸ¼)))
            ğŸ“ = ğŸ“Œ*ğŸ”²ğŸ”ï¸ğŸ“ğŸ”ï¸
        }
        
        ğŸ”ï¸ğŸ—ºï¸ğŸ—ºï¸ = ğŸ²ğŸ—ºï¸()
        ğŸ”ï¸ğŸ—ºï¸ğŸ—ºï¸.ğŸ”²ğŸ¼ = ğŸ”²ğŸ¼
        ğŸ”ï¸ğŸ—ºï¸ğŸ—ºï¸.ğŸª¨ = 0.75
        ğŸ”ï¸ğŸ—ºï¸ğŸ—ºï¸.ğŸ”²ğŸ“ = ğŸ“/Int(pow(2.0, Double(ğŸ”²ğŸ¼))) + 1
        ğŸ”ï¸ğŸ—ºï¸ğŸ—ºï¸.ğŸ”²ğŸ“ = ğŸ“/Int(pow(2.0, Double(ğŸ”²ğŸ¼))) + 1
        ğŸ”ï¸ğŸ—ºï¸ğŸ—ºï¸.ğŸ”²ğŸ”ï¸ğŸ“ğŸ”ï¸ = ğŸ”²ğŸ”ï¸ğŸ“ğŸ”ï¸ * Int(pow(2.0, Double(ğŸ”²ğŸ¼)))
        ğŸ”ï¸ğŸ—ºï¸ğŸ—ºï¸.ğŸ› ï¸ğŸ²ğŸ—ºï¸()
        ğŸ”ï¸ğŸ—ºï¸ğŸ—ºï¸.ğŸ› ï¸ğŸ”ï¸ğŸ“ğŸ”ï¸()
        
        return ğŸ”ï¸ğŸ—ºï¸ğŸ—ºï¸.ğŸ”ï¸ğŸ“ğŸ”ï¸ğŸ—ºï¸
    }
    
    func ğŸ›«ğŸ‘†(_ ğŸ‘†: Int, _ ğŸ²ğŸ—ºï¸ğŸ—ºï¸ğŸ“: [Double])
    {
        ğŸ“ğŸ“ğŸ².async
        {
            for ğŸ–• in 0..<ğŸ²ğŸ—ºï¸ğŸ—ºï¸ğŸ“.count
            {
                let ğŸ”ï¸ğŸ“ = Int(Double(self.ğŸ¨ğŸ¨.count-1) * ğŸ²ğŸ—ºï¸ğŸ—ºï¸ğŸ“[ğŸ–•])
                let ğŸ¨ = self.ğŸ¨ğŸ¨[ğŸ”ï¸ğŸ“]
                var ğŸ•ï¸ = ğŸ’¨ + ğŸ’¨
                
                if let ğŸ¨ğŸ•ï¸ = self.ğŸ¨ğŸ•ï¸ğŸ•ï¸[ğŸ¨]
                {
                    if ğŸ¨ğŸ•ï¸.count > 0
                    {
                        ğŸ•ï¸ = ğŸ¨ğŸ•ï¸[Int.random(in: 0..<ğŸ¨ğŸ•ï¸.count)]
                    }
                }
                
                var ğŸ§© = ğŸŒğŸ§©(ğŸ¨, ğŸ•ï¸)
                
                if ğŸ¨ == "\u{001B}[48;5;21m" || ğŸ¨ == "\u{001B}[48;5;39m"
                {
                    let ğŸŒŠğŸ§© = ğŸŒŠ(ğŸ¨, ğŸ•ï¸)
                    ğŸŒŠğŸ§©.ğŸ‘† = ğŸ–•
                    ğŸŒŠğŸ§©.ğŸ–• = ğŸ‘†
                    ğŸ§© = ğŸŒŠğŸ§©
                }
                else if ğŸ¨ == "\u{001B}[48;5;51m" || ğŸ¨ == "\u{001B}[48;5;15m"
                {
                    ğŸ§©.ğŸš· = ğŸ‘
                }
                
                self.ğŸŒğŸ§©ğŸ§©ğŸ§©[ğŸ‘†][ğŸ–•] = ğŸ§©
            }
            
            self.ğŸ§®ğŸ² += 1
        }
    }
    
    func ğŸ›«()
    {
        let ğŸ²ğŸ—ºï¸ğŸ—ºï¸ = ğŸ› ï¸ğŸ”ï¸ğŸ—ºï¸()
        
        ğŸ§®ğŸ² = 0
        ğŸ“ğŸ“ğŸ² = DispatchQueue(label: "ğŸ²")
        
        ğŸŒğŸ§©ğŸ§©ğŸ§© = []
        
        for ğŸ‘† in 0..<ğŸ²ğŸ—ºï¸ğŸ—ºï¸.count
        {
            let ğŸŒğŸ§©ğŸ§© = [ğŸŒğŸ§©](repeating: ğŸŒğŸ§©(ğŸ«™, ğŸ«™), count: ğŸ²ğŸ—ºï¸ğŸ—ºï¸[ğŸ‘†].count)
            ğŸŒğŸ§©ğŸ§©ğŸ§©.append(ğŸŒğŸ§©ğŸ§©)
        }
        
        for ğŸ‘† in 0..<ğŸ²ğŸ—ºï¸ğŸ—ºï¸.count
        {
            ğŸ›«ğŸ‘†(ğŸ‘†, ğŸ²ğŸ—ºï¸ğŸ—ºï¸[ğŸ‘†])
        }
        
        while ğŸ§®ğŸ² < ğŸ²ğŸ—ºï¸ğŸ—ºï¸.count
        {
            ğŸ‘©â€ğŸ¦½ğŸ«™()
        }
    }
}
